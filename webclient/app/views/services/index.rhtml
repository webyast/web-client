<html>
  <head>
    <title>services</title>
    <%= javascript_include_tag "prototype" %>
  </head>


<script language="javascript">
 
  YAHOO.namespace('yuiresult');

  function initResultDialog() {
    var handleCancel = function() {
      this.cancel();
    }

    YAHOO.yuiresult.resultDialog = new YAHOO.widget.Dialog("resultdlg", {
       width: "625px",
       modal: true, 
       visible: false,
       fixedcenter: true, 
       constraintoviewport: true, 
       draggable: true });

    YAHOO.yuiresult.resultDialog.render();
  }

  function showResultDialog() {
    YAHOO.yuiresult.resultDialog.show();
  }

  YAHOO.util.Event.addListener(window, "load", initResultDialog);
</script>


<!-- begin: dialog box -->
<div id="resultdlg">
</div>
<!-- end: dialog box -->

<body>

<h1>Services</h1>
<br>

<% for tableCounter in 0..@table.size-1 do %>
   <div class="table">
      <img src="/images/bg-th-left.gif" width="8" height="7" alt="" class="left" />
      <img src="/images/bg-th-right.gif" width="7" height="7" alt="" class="right" />
      <table class="listing" cellpadding="0" cellspacing="0">
         <tr>
           <% for columnCounter in 0..3 do %>
              <% if @services.size > tableCounter*4+columnCounter %>
                 <% if columnCounter == 0 %>
    	            <th class="first" width=17%><%=h @services[tableCounter*4+columnCounter].link %></th>
                 <% elsif columnCounter == 3 %>
    	            <th class="last" width=17%><%=h @services[tableCounter*4+columnCounter].link %></th>
                 <% else %>
    	            <th width=17%><%=h @services[tableCounter*4+columnCounter].link %></th>
                 <% end %>
              <% else %>
                 <% if columnCounter == 3 %>
    	            <th class="last" width=17%></th>
                 <% else %>
    	            <th width=17%></th>
                 <% end %>
              <% end %>
           <% end %>
         </tr>
         <% for lineCounter in 0..@table[tableCounter]-1 do %>         
            <tr>
               <% for columnCounter in 0..3 do %>
                  <% if @services.size > tableCounter*4+columnCounter %>
                     <% commandList = @services[tableCounter*4+columnCounter].commandList %>
                     <% if lineCounter < commandList.size %>
                        <td>
                            <% if commandList[lineCounter][:name] == "configure" %>
                               <%= link_to image_tag("#{commandList[lineCounter][:icon]}", :alt =>  "icon"), 
                                                     :id=>"config",
                                                     :action =>@services[tableCounter*4+columnCounter].link %>
                               <strong><%= link_to "#{commandList[lineCounter][:name]}",  :id=>"config",
                                                     :action =>@services[tableCounter*4+columnCounter].link %></strong>
                            <% else %>
                               <% if @executePermission == nil %>
                                  <%= link_to_remote image_tag("#{commandList[lineCounter][:icon]}", :alt =>  "icon"), 
                                                   :update => "resultdlg",
						   :url=>{ :id=> commandList[lineCounter][:name], 
                                                           :action => "execute", 
                                                           :service_id=> @services[tableCounter*4+columnCounter].link },
						   :loading => "Element.show('progress');",
						   :complete => "Element.hide('progress'); showResultDialog();" %>
                                  <strong><%= link_to_remote "#{commandList[lineCounter][:name]}",
                                                   :update => "resultdlg",
						   :url=>{ :id=> commandList[lineCounter][:name], 
                                                           :action => "execute", 
                                                           :service_id=> @services[tableCounter*4+columnCounter].link },
						   :loading => "Element.show('progress');",
						   :complete => "Element.hide('progress'); showResultDialog();"
                                          %></strong>
                               <% else %>
                                  <%= image_tag("#{commandList[lineCounter][:icon]}", :alt =>  "icon") %>
                                  <strong><span style="color: #BDBDBD"><%="#{commandList[lineCounter][:name]}" -%></span></strong>
                               <% end %> 
                            <% end %> 
                        </td>
                     <% else %> 
                        <td> </td>
                     <% end %> 
                  <% else %>
                     <% if columnCounter == 3 %>
    	                <td class="last" width=17%></td>
                     <% else %>
      	                <td width=17%></td>
                     <% end %>
                  <% end %> 
               <% end %> 
            </tr>
         <% end %>
      </table>
   </div>
<% end %>
<body>
</html>
