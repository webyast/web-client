<html>
<head>
  <title>YUI Tester: <%= controller.action_name %></title>
  <%= javascript_include_tag "yui/yahoo",
                             "yui/dom",
                             "yui/event",
                             "yui/connection",
                             "yui/dragdrop",
                             "yui/treeview"%>
    <%= stylesheet_link_tag  'yui/treeview'%>

    <%= stylesheet_link_tag 'permission'%>

 </head>

<body>
    <div id="mytree"></div>


<% test_data="var test_data = \n"+
	     "[0, { label: \"Cat 1\", href:\"http://www.yahoo.com\" },\n"+
	     " 1, { label: \"Cat 1.1\", href:\"http://www.yahoo.com\" },\n"+
             " 1, { label: \"Cat 1.2\", href:\"http://www.yahoo.com\" },\n"+
	     " 2, { label: \"Cat 1.2.1\", href:\"http://www.yahoo.com\" },\n"+
	     " 2, { label: \"Cat 1.2.2\", href:\"http://www.yahoo.com\" },\n"+
	     " 1, { label: \"Cat 1.3\", href:\"http://www.yahoo.com\" },\n"+
	     " 0, { label: \"Cat 2\", href:\"http://www.yahoo.com\" }];" %>

<script type="text/javascript">
//<![CDATA[
   <%= "#{test_data}" %>
//]]>

//<![CDATA[

function addChildrenNodes(currLevel, nodeIndex, parent) {
  var lastNode;
  var level = currLevel;

  while (nodeIndex < test_data.length) {
    var level = test_data[nodeIndex];
    if (level == currLevel) {
       nodeIndex++;
       lastNode = new YAHOO.widget.TextNode(test_data[nodeIndex++], parent, false);
    } else if (level < currLevel) {
       return nodeIndex;
    } else {
       nodeIndex = addChildrenNodes(level, nodeIndex, lastNode);
    }
  }
  return nodeIndex;
}

function mytree_Init() {
  var tree = new YAHOO.widget.TreeView("mytree");
  addChildrenNodes(0, 0, tree.getRoot());
  tree.draw();
}

YAHOO.util.Event.addListener(window, "load", mytree_Init);

//]]>

</script>

</body>
</html>
