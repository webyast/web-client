<%= report_error(error, _("A problem occured when loading status information.")) if error %>

<script type="text/javascript">

<% if data %>
  $.jqplot('<%=graph_id(data[:group_id], data[:graph_id])%>',  [
  <% data[:lines].each do |line| %>
    <%= line[:values].inspect %>,
  <% end %>
  <% data[:limits].each do |line| %>
    <%= line[:values].inspect %>,
  <% end %>
   ], {
    <% if data[:cummulated] == "true" %>
      stackSeries: true,
    <% else %>
      stackSeries: false,
    <% end %>
    title: '<%=data[:y_label]%>',
    legend: {show: true, location: 'ne'},
    seriesDefaults: {fill:true, showMarker: false},
    series: [
      <% data[:lines].each do |line| %>
        <% if  line[:limit_reached].blank?  %>
          {label: '<%=line[:label]%>'}, 
        <% else %>
          {label: '<%=line[:label] + " " + line[:limit_reached]%>',
           color: '#FF0000'}, 
        <% end %>
      <% end %>
      <% data[:limits].each do |line| %>
        {fill:false, 
         <% unless line[:reached].blank? %>
           color:'#FF0000',
         <% else %>
           color:'#5FAB78',
         <% end %>
         lineWidth: 1,
         label: '<%= line[:label] + " " + line[:reached]  %>'},
      <% end %>
    ],
    axes: {
        xaxis: { renderer:$.jqplot.DateAxisRenderer,
                 tickOptions:{formatString:'%X'},
                 numberTicks:7},
        yaxis: { min: 0,
                 numberTicks:7}
    }
  });
<% end %>

</script>


