<% write_disabled = !true %>

<% content_for :head do %>
   <%= javascript_include_tag :defaults %>
   <link rel="stylesheet" href="/inc/smoothness/jquery.ui.custom.css" type="text/css" media="screen" title="default" charset="utf-8" />
<% end %>

<div class='plugin-icon'><img src='/images/monitoring.png'/><%=_("Status")%></div>
<div class="plugin-content grid_12">
<h2><%= _("Settings") %></h2>

<% form_tag( {:action => :save} , {:class => 'tab-form'} ) do %>
  <ul class="tab-nav">
    <!-- javascript adds tabs here -->
  </ul>

  <% @graphs.each do |group| %>
    <fieldset id=<%= group.id %> class="ui-tab">
      <legend><%= group.id %></legend>    
        <br>	
        <p>Alarm, if</p>
        <p>
        <div class="table">
        <table class="list">
          <% group.single_graphs.each do |single_graph| %>
            <% if group.single_graphs.size > 1 %>
              <tr>
                <td width="180">
                   <b><%= "#{single_graph.headline}" %></b>
                </td>
              <tr>
            <% end %>
            <% single_graph.lines.each do |line| %>
              <% limit_key = "#{group.id}/#{single_graph.headline}/#{line.label}" 
                 measurements = {_("undercuts") => "min", _("exceeds") => "max"}
                 if line.limits.max.to_i > 0
                    val = line.limits.max.to_i
                    measurement = "max"
                 elsif line.limits.min.to_i > 0
                    val = line.limits.min.to_i
                    measurement = "min"
                 else
                    val = ""
                    measurement = "max"
                 end
              %>
              <tr>
                <td width="180">
                  <%= "#{line.label}" %>
                </td>
                <td>
                  <%= select_tag("measurement/"+limit_key, options_for_select(measurements, measurement), :disabled => write_disabled)%>
                </td>
                <td>
                  <%=text_field_tag "value/"+limit_key, val, :disabled => write_disabled %>
                </td>
                <td>
                  <%= "#{group.y_label}" %>
                </td>
              </tr>
            <% end %>
          <% end %>
        </table>
        </div>
    </fieldset>
  <% end %>

  <p>
    <%= form_send_buttons :disabled => write_disabled %>
  </p>
<% end %>
</div>