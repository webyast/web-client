<%#
#--
# Copyright (c) 2009-2010 Novell, Inc.
# 
# All Rights Reserved.
# 
# This program is free software; you can redistribute it and/or modify it
# under the terms of version 2 of the GNU General Public License
# as published by the Free Software Foundation.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program; if not, contact Novell, Inc.
# 
# To contact Novell about this file by physical or electronic mail,
# you may find current contact information at www.novell.com
#++
%>
  <% javascript_tag do -%>
    function check_all() {
        $("INPUT[type='checkbox']").attr('checked', $('#All').is(':checked'));      
    };
  <% end %>
<table summary="" class="patches" <%= @patch_updates.empty? ? "style=\"visibility: hidden;\"" : "" %> >
  <tr>
    <th class="first checkbox" width=8% >
      <input type="checkbox" name="All" onclick="check_all()" id="All" style="float: left;"></input>
      <div style="margin-top: 2px;"><%=_("Check")%></div>
    </th>
    <th width=5%><%=_("Kind")%></th>
    <th width=15%><%=_("Name")%></th>
    <th width="100"><%=_("Summary")%></th>
    <% if @permissions[:install] %>
      <th width=25%><%=_("Source")%></th>
      <th class="last" width=5%><%=_("Install")%></th>
    <% else %>
      <th class="last" width=15%><%=_("Source")%></th>
    <% end %>
  </tr>
  <%
  # this should go to a helper?
  kinds = { "security" => '/icons/kupdateapplet_red.png',
    "important" => '/icons/kupdateapplet_yellow.png',
    "green" => '/icons/kupdateapplet_green.png',
    "optional" => '/icons/kupdateapplet_optional.png' }
%>
  <% @patch_updates.each do |patch_update| %>
    <tr>
      <td class="checkbox"><input type="checkbox" id=<%= "patch_#{patch_update.resolvable_id}" %> name=<%="patch_#{patch_update.resolvable_id}" %> value=<%=patch_update.resolvable_id%> /></td>

      <% if kinds.has_key?(patch_update.kind) %>
        <td class="icon" ><%= image_tag(kinds[patch_update.kind]) %> </td>
      <% else %>
        <td><%=h patch_update.kind %></td>
      <% end %>

      <td class="label"><%=h patch_update.name %></td>
      <td class="label"><%=h patch_update.summary %></td>
      <td class="icon"><%=h patch_update.repo %></td>
      <% if @permissions[:install] %>
        <td><%= link_to image_tag("/icons/system-software-install.png"\
              , :alt =>  "install", :class=>"icon", :border => "0"),\
            :controller => 'patch_updates', :id => patch_update.resolvable_id,\
            :onclick=>"$('#progress').show()", :method => :post, :action => "install" %></td>
        <% end %>
    </tr>
  <% end %>
</table>

