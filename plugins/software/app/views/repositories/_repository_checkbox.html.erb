<%#
# This partial template renders a repository checkbox with AJAX function
# for enabling/disabling it, a progress is displayed after clicking it
# 
# local valiables:
#    string  error    - error message
#    string  id       - repository alias
#    boolean enabled  - true if the repository is enabled
#    boolean disabled - true if the checkbox should be disabled (grayed)
%>

<%# jQuery doesn't work properly when the selector contains some metacharcaters, escape them
    see http://docs.jquery.com/Selectors %>
  <% jquery_id = safe_id id -%>

  <%= image_tag 'working.gif', :height => 16, :width => 16, :border => 0,
    :id => "repo_progress_#{jquery_id}",
    :style => 'display: none', :alt => 'working...' -%>

  <input type="checkbox" id="repo_status_<%= jquery_id -%>" <%= disabled ? ' disabled ' : '' -%> <%= enabled ? ' checked ' : '' -%>
	 onclick="<%=  remote_function(:update => "#repo_cell_#{jquery_id}",
    :loading  => "$('#repo_progress_#{jquery_id}').show(); $('#repo_status_#{jquery_id}').hide()",
    :url => { :action => :set_status, :id => id, :params => { :enabled => (!enabled).to_s}}) -%>"
	 />
<% if !error.blank? -%>
  <div style="font-size: 0.7em; color:red;">Error: <%= h error %></div>
<% end -%>
