<% if @permissions and @patch_updates %>
  <%= javascript_include_tag :defaults %>
  <% javascript_tag do -%>
    $(document).ready(function() {
      $('#All').click(function() {
        $("INPUT[type='checkbox']").attr('checked', $('#All').is(':checked'));
      });
    });
  <% end %>
  <style type="text/css">

    option[value=security]:before { content:url('/icons/kupdateapplet_red.png'); }
    option[value=important]:before { content:url('/icons/kupdateapplet_yellow.png'); }
    option[value=green]:before { content:url('/icons/kupdateapplet_green.png'); }
    option[value=optional]:before { content:url('/icons/kupdateapplet_optional.png'); }

  </style>
  <div class='plugin-icon'><img src='/icons/yast-online_update.png'/></div>
  <div class='plugin-content'>
  <h2>Updates</h2>
  <div class="loading"></div>
  <% if @patch_updates.empty? %>
    <p><%=_("Your system is up to date.") %></p>
  <% else %>
    <p><%=_("Updates available") %></p>
  <% end %>

  <select name="selector" id="selector" size="1">
    <option value="all">All</option>
    <option value="security">Security</option>
    <option value="important">Important</option>
    <option value="green">Green</option>
    <option value="optional">Optional</option>
  </select>
  <% form_for :patch_updates, :url => { :action => "install" }, :html => {:id => "patches-form"} do |form| %>

    <div id="patchesd"><%= render :partial => "patches"%></div>

    <input type="checkbox" name="All" id="All">All</input>

    <%= submit_tag _("Update"), :onclick=>"Element.show('progress')", :action => 'install', :class => 'button' -%>
    <a href="/" class="button"><%=_("Back")%></a>
  <% end %>
  </div>

<% end %>

<%= observe_field(:selector,
  :frequency => 0.1,
  :update => :patchesd,
  :url => { :action => :load_filtered },
  :with => "'value=' + value"
)
%>

