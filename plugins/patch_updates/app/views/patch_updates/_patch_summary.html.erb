<%= report_error(error, _("An error occured when loading patch information.")) if error %>

<div class="status_patches">
  <% unless patch %>    
    <div class="status-icon warning"></div>    
    <%= _("No information about patches available") %>
  <% else %>
    <% label = [] %>
    <% link_to "patch_updates" do %>
      <% if patch[:security]+patch[:important] > 0 %>
        <div class="status-icon error"></div>
      <% elsif patch[:optional] > 0%>
        <div class="status-icon warning"></div>
      <% else %>
        <div class="status-icon ok"></div>
      <% end %>

      <% if patch[:security] > 0 %>
        <% label << _("Security Updates: #{patch[:security]}") %>
      <% end %>
      <% if patch[:important] > 0 %>
	<% label << _("Important Updates: #{patch[:important]}") %>
      <% end %>
      <% if patch[:optional] > 0 %>
	<% label << _("Optional Updates: #{patch[:optional]}") %>
      <% end %>
      <% if label.empty? %>
	<% label << _("Your system is up to date.") %>
      <% end %>
      <span><%= label.join(", ") %></span>
    <% end %>
    <% if not label.empty? %>
      <%= button_to_remote "Update All", :update =>"status_patches", :url => { :controller => :patch_updates, :action => :start_install_all}, :confirm => _("Updating all. Are you sure?") %>
    <% end %>

  <% end %>
</div>
